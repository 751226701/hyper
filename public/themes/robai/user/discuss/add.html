<!DOCTYPE html>
<html>
<head>
<title>{$user_login}  - 我的话题</title>
<meta name="keywords" content=""/>
<meta name="description" content="">
<include file="public@head"/>
</head>

<body class="body-white" id="top">
<include file="public@nav" />
<div class="default-padding">
	<div class="container tc-main">
		<div class="row">
			<div class="col-md-3">
				<include file="public@usernav" />
			</div>
			<div class="col-md-9">
				<div class="tabs">
					<ul class="nav nav-tabs">
						<!--<li class="active"><a href="#one" data-toggle="tab"><i class="fa fa-star"></i> 我的话题</a></li>-->
						<li class="navbar-left"><a href="{:url('user/discuss/index')}"><i class="fa fa-file-text fa-fw"></i> 我的话题</a></li>
						<li class="navbar-right active"><a href="javascript:;"><i class="fa fa-plus-circle"></i> 发布话题</a></li>
					</ul>
					<div class="tab-content">
						<div class="tab-pane active" id="one">
						    <br>
						    <form class="js-ajax-form" action="{:url('user/discuss/addPost')}" method="post">
						        <input type="hidden" name="user_id" id="" value="$user['id']" />
						        <div class="form-group">
						            <label>话题分类<span class="form-required">*</span></label>
						            <input class="form-control" type="text" required value=""
                                           placeholder="请选择分类" onclick="doSelectCategory();" id="js-categories-name-input"
                                           readonly/>
                                    <input class="form-control" type="hidden" value="" name="categories"
                                            id="js-categories-id-input"/>
						        </div>
                                <div class="form-group">
                                    <label>标题<span class="form-required">*</span></label>
                                    <input class="form-control" type="text" name="post_title" id="title" required value="" placeholder="请输入标题"/>
                                </div>
                                <div class="form-group">
                                    <label>内容</label>
                                    <script type="text/plain" id="content" name="post_content"></script>
                                </div>
                                <!--<button type="submit" class="btn btn-primary js-ajax-submit">发布</button>-->
                                <button type="submit" class="btn btn-primary js-ajax-submit">发布</button>
                            </form>
						</div>
					</div>
				</div>
			</div>
		</div>
		
	</div>
</div>
<include file="public@footer" />
<!-- /container -->
<include file="public@scripts" />
<script type="text/javascript" src="__STATIC__/js/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="__STATIC__/js/ueditor/ueditor.all.min.js"></script>
<script type="text/javascript">
    $(function () {

        editorcontent = new baidu.editor.ui.Editor();
        editorcontent.render('content');
        try {
            editorcontent.sync();
        } catch (err) {
        }
    });
</script>
<script type="text/javascript" charset="utf-8">
     function doSelectCategory() {
        var selectedCategoriesId = $('#js-categories-id-input').val();
        openIframeLayer("{:url('user/discuss/select')}?ids=" + selectedCategoriesId, '请选择分类', {
            area: ['700px', '400px'],
            btn: ['确定', '取消'],
            yes: function (index, layero) {
                //do something

                var iframeWin = window[layero.find('iframe')[0]['name']];
                var selectedCategories = iframeWin.confirm();
                if (selectedCategories.selectedCategoriesId.length == 0) {
                    layer.msg('请选择分类');
                    return;
                }
                $('#js-categories-id-input').val(selectedCategories.selectedCategoriesId.join(','));
                $('#js-categories-name-input').val(selectedCategories.selectedCategoriesName.join(' '));
                //console.log(layer.getFrameIndex(index));
                layer.close(index); //如果设定了yes回调，需进行手工关闭
            }
        });
    }
</script>
</body>
</html>